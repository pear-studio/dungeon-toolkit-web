## ADDED Requirements

### Requirement: 向导入口与规则集选择
系统 SHALL 在角色创建向导第一步展示可用规则集供用户选择，角色创建后规则集不可更改。

#### Scenario: 展示规则集列表
- **WHEN** 用户进入角色创建向导
- **THEN** 系统展示所有 is_active=true 的规则集，每个规则集显示名称和简介

#### Scenario: 选择规则集后进入下一步
- **WHEN** 用户选择一个规则集并点击继续
- **THEN** 向导进入第二步，后续所有游戏数据均基于该规则集过滤

---

### Requirement: 基础信息填写
系统 SHALL 在向导第二步收集角色的基础信息。

#### Scenario: 填写基础信息
- **WHEN** 用户填写角色名（必填）、性别、年龄、外貌描述并继续
- **THEN** 向导进入第三步，基础信息暂存于向导状态

#### Scenario: 角色名为空
- **WHEN** 用户未填写角色名直接点击继续
- **THEN** 系统提示角色名为必填项，不允许进入下一步

---

### Requirement: 种族选择
系统 SHALL 在向导第三步展示种族列表，并在用户选择后展示该种族的详细特性。

#### Scenario: 展示种族卡片列表
- **WHEN** 用户进入种族选择步骤
- **THEN** 系统展示当前规则集下所有种族的卡片（含名称、简介、属性加值预览）

#### Scenario: 选择种族后展示特性
- **WHEN** 用户点击某个种族卡片
- **THEN** 系统在右侧/展开区显示该种族完整特性（速度、体型、种族特性列表、语言）

#### Scenario: 选择含亚种族的种族
- **WHEN** 用户选择了含有亚种族的种族（如精灵）
- **THEN** 系统在同一步骤内展示亚种族选项，用户 MUST 选择一个亚种族才能继续

#### Scenario: 无亚种族的种族直接继续
- **WHEN** 用户选择了无亚种族的种族（如人类）并点击继续
- **THEN** 向导直接进入第四步

---

### Requirement: 职业选择
系统 SHALL 在向导第四步展示职业列表，并在用户选择后展示该职业的详细信息。

#### Scenario: 展示职业卡片列表
- **WHEN** 用户进入职业选择步骤
- **THEN** 系统展示当前规则集下所有职业，每张卡片含名称、命中骰、定位标签（输出/控场/辅助/坦克）

#### Scenario: 选择职业后展示特性
- **WHEN** 用户点击某个职业卡片
- **THEN** 系统展示该职业的1级特性、熟练项（护甲/武器/豁免/技能数量）和主要属性

#### Scenario: 法术类职业标记
- **WHEN** 展示职业列表时
- **THEN** 具有施法能力的职业（法师/术士/牧师等）SHALL 有明显标记，以告知用户后续有法术选择步骤

---

### Requirement: 属性值分配
系统 SHALL 在向导第五步提供三种属性值分配方式，并自动叠加种族属性加值。

#### Scenario: 标准数组分配
- **WHEN** 用户选择"标准数组"方式，将 [15,14,13,12,10,8] 拖拽分配到六维属性
- **THEN** 系统实时显示每个属性的最终值（基础值+种族加值）和对应修正值

#### Scenario: 点数购买分配
- **WHEN** 用户选择"点数购买"方式（总计27点）
- **THEN** 系统展示交互式点数分配界面，实时显示剩余点数，属性范围限定在8-15之间

#### Scenario: 手动输入分配
- **WHEN** 用户选择"手动输入"方式并填写六个数值
- **THEN** 系统接受任意正整数输入（不做范围限制），叠加种族加值后显示结果

#### Scenario: 分配完成校验
- **WHEN** 用户点击继续
- **THEN** 系统校验六个属性均已分配，否则提示未完成分配

---

### Requirement: 背景选择
系统 SHALL 在向导第六步展示背景列表，并提供性格特质等角色扮演信息的填写。

#### Scenario: 展示背景列表
- **WHEN** 用户进入背景选择步骤
- **THEN** 系统展示所有背景，每个背景显示名称、技能熟练项和背景特性名称

#### Scenario: 选择背景后展示详情
- **WHEN** 用户选择某个背景
- **THEN** 系统展示该背景的完整信息（技能/工具/语言/装备/特性描述）

#### Scenario: 性格特质随机生成
- **WHEN** 用户点击"随机"按钮
- **THEN** 系统从该背景的预设列表中随机填入性格特质、理念、牵绊、缺点各一条

#### Scenario: 性格特质自定义
- **WHEN** 用户直接在文本框编辑
- **THEN** 系统保存用户自定义内容，允许为空

---

### Requirement: 法术选择（法术职业专属）
系统 SHALL 在向导第七步为具有施法能力的职业展示法术选择界面，非施法职业跳过此步骤。

#### Scenario: 非施法职业跳过
- **WHEN** 用户选择的职业没有施法能力（如战士基础版/野蛮人）
- **THEN** 向导跳过第七步，直接进入第八步

#### Scenario: 施法职业展示法术选择
- **WHEN** 用户选择的职业有施法能力（如法师/牧师）
- **THEN** 系统根据职业规则展示可选戏法数量和已知/准备法术数量，并列出可选法术

#### Scenario: 法术过滤
- **WHEN** 用户在法术列表中按环级/系别过滤
- **THEN** 系统实时过滤展示符合条件的法术

#### Scenario: 法术数量达上限
- **WHEN** 用户已选满该职业1级可知晓的法术数量
- **THEN** 系统禁用其余法术的选择，提示已达上限

---

### Requirement: 初始装备选择
系统 SHALL 在向导第八步提供初始装备选项。

#### Scenario: 展示装备选项
- **WHEN** 用户进入装备选择步骤
- **THEN** 系统根据职业和背景展示预设装备包选项（如"a.链甲 或 b.皮甲+两把匕首"）

#### Scenario: 选择装备包
- **WHEN** 用户选择一个装备包选项
- **THEN** 系统将对应装备列表暂存至角色物品栏

---

### Requirement: 向导完成与角色创建
系统 SHALL 在用户完成所有步骤后展示角色预览，并在用户确认后创建角色记录。

#### Scenario: 展示角色预览
- **WHEN** 用户完成第八步并点击继续
- **THEN** 系统展示完整的角色信息摘要（基础信息/种族/职业/属性/技能/法术/装备）

#### Scenario: 确认创建角色
- **WHEN** 用户在预览页点击"创建角色"
- **THEN** 系统向 POST /api/characters/ 提交完整角色数据，创建成功后跳转至角色详情页，HTTP 201

#### Scenario: 向导中途返回修改
- **WHEN** 用户在任意步骤点击"上一步"
- **THEN** 系统返回上一步并保留已填写的数据

#### Scenario: 向导步骤导航
- **WHEN** 用户查看向导顶部步骤导航条
- **THEN** 已完成的步骤显示为已完成状态，当前步骤高亮，未完成步骤显示为待完成状态

# AI 使用标准

本文件定义了 AI 在本项目中的使用规范，确保 AI 辅助开发时遵循统一标准。

---

## 适用场景

### 适合 AI 的任务

| 任务类型 | 说明 |
|---------|------|
| 代码生成 | 根据明确需求生成代码实现 |
| 问题排查 | 定位和修复已知问题 |
| 代码重构 | 优化现有代码结构 |
| 文档编写 | 生成或更新项目文档 |
| 批量修改 | 按模式批量修改代码 |
| 数据解析 | 使用 parsers 目录下的解析脚本生成 JSON 数据 |

### 不适合 AI 的任务

| 任务类型 | 说明 |
|---------|------|
| 原创规则设计 | D&D 规则必须从 `rules_source/` 读取 |
| 关键决策 | 架构选择、安全策略需人工决定 |
| 敏感操作 | 数据库迁移、生产环境操作需人工确认 |

---

## 上下文管理

### 会话开始

AI 应主动了解项目上下文：

1. **阅读项目规范**：查看 `docs/conventions/` 下的规范文件
2. **了解技术栈**：确认前端/后端技术选型
3. **检查现有实现**：避免重复造轮子

### 会话进行中

1. **记录关键信息**：将重要发现记录到会话中
2. **引用规范**：涉及规范时，标注依据的文件路径
3. **避免重复询问**：同一问题只问一次，记录答案

### 会话结束

无需特殊操作，重要上下文已在会话过程中记录。

---

## 项目规则引用

本项目使用 TRAE IDE 的项目规则功能。相关规则位于 `.trae/rule/` 目录。

### 规则文件

| 文件 | 作用 |
|------|------|
| `ai-usage.md` | AI 使用标准（本文件） |
| `data-sources.md` | 数据来源规范 |
| `code-style-python.md` | Python 代码风格 |
| `code-style-typescript.md` | TypeScript 代码风格 |

### 规则生效方式

- **始终生效**：`ai-usage.md` 在所有 AI 对话中生效
- **指定文件生效**：代码风格规则在匹配的文件类型中生效

---

## 输出验证

AI 生成的代码应通过以下验证：

### 代码审查要点

1. **数据来源**：是否从 `rules_source/` 读取，而非凭记忆生成
2. **安全检查**：
   - 无硬编码密钥/密码
   - 无 SQL 注入风险
   - 无 XSS 漏洞
3. **代码规范**：
   - 符合 `code-style-python.md` 或 `code-style-typescript.md`
   - 变量/函数命名清晰
4. **测试验证**：
   - 运行项目测试（若有）
   - 检查是否有语法错误

### 验证流程

```
生成代码 → 审查要点检查 → 必要时修正 → 提交
```

---

## 常见约束

### 数据生成

- **必须使用** `backend/data/parsers/` 下的解析脚本（如 `parse_backgrounds.py`）生成 JSON 数据
- **禁止** 直接修改 JSON 文件或凭记忆生成数据
- **禁止** 跳过 `rules_source/` 直接写 JSON

### 代码修改

- **优先最小化**：只改必要部分，避免大范围重构
- **保持一致**：与现有代码风格保持一致
- **更新文档**：若功能变更涉及文档，同步更新

### 问题处理

- 遇到不确定的问题，先询问用户再行动
- 发现潜在风险，明确告知用户并请求确认

---

## 相关规范

- 数据来源：[`data-sources.md`](./data-sources.md)
- 前端规范：[`frontend.md`](./frontend.md)
- 部署指南：[`../deployment.md`](../deployment.md)
